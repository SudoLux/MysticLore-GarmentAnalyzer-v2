<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mystic Lore Garment Analyzer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background-color: var(--color-bg);
            color: var(--color-text);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        :root {
            --color-bg: #EDE3CF;
            --color-text: #3D2B1F;
            --color-text-muted: #6b5a4d;
            --color-accent: #1B3A63;
            --color-highlight: #C89B3C;
            --color-glass-bg: rgba(237, 227, 207, 0.6);
            --color-glass-border: rgba(61, 43, 31, 0.3);
            --color-card-bg: rgba(237, 227, 207, 0.8);
            --color-chip-bg: #C89B3C;
            --color-chip-text: #3D2B1F;
            --color-progress-bg: #d4c9b5;
            --color-error: #ef4444;
            --color-accent-glass-bg: rgba(27, 58, 99, 0.2);
            --color-accent-glass-border: rgba(27, 58, 99, 0.3);
        }

        body.dark {
            --color-bg: #0A0A0A;
            --color-text: #FFFFFF;
            --color-text-muted: #a0a0a0;
            --color-accent: #1B3A63;
            --color-highlight: #C89B3C;
            --color-glass-bg: rgba(20, 20, 20, 0.6);
            --color-glass-border: rgba(255, 255, 255, 0.3);
            --color-card-bg: rgba(20, 20, 20, 0.6);
            --color-chip-bg: #C89B3C;
            --color-chip-text: #0A0A0A;
            --color-progress-bg: #333333;
            --color-error: #f87171;
            --color-accent-glass-bg: rgba(27, 58, 99, 0.15);
            --color-accent-glass-border: rgba(27, 58, 99, 0.2);
        }

        .pill-button {
            border-radius: 9999px;
            padding: 0.5rem 1.25rem;
            font-weight: 600;
            transition: all 0.2s ease;
        }
    </style>
    <style>
        /* Styles for PDF Export */
        body.pdf-export-mode {
            background-color: white !important;
        }
        
        .pdf-export-mode body > #root > *:not(#printable-guide) {
            display: none !important;
        }

        .pdf-export-mode main {
            display: block !important;
            align-items: start !important;
        }

        #printable-guide {
            display: none;
        }
        
        body.pdf-export-mode #printable-guide {
            display: block !important;
            position: absolute;
            top: 0;
            left: 0;
            z-index: -1;
        }

        .pdf-page {
            width: 210mm;
            height: 297mm; /* A4 Portrait Height */
            padding: 18mm;
            box-sizing: border-box;
            overflow: hidden; /* Ensure content doesn't spill out */
            background-color: white !important;
            color: #3D2B1F !important;
            display: flex;
            flex-direction: column;
        }

        .pdf-export-mode .backdrop-blur-lg, 
        .pdf-export-mode .backdrop-blur-xl {
            backdrop-filter: none !important;
        }

        .pdf-export-mode .shadow-lg, 
        .pdf-export-mode .shadow-xl, 
        .pdf-export-mode .shadow-sm {
            box-shadow: none !important;
        }
        
        /* Compact styles for PDF export */
        .pdf-export-mode #printable-guide {
            font-size: 10pt;
            line-height: 1.5;
        }
        .pdf-export-mode #printable-guide h1,
        .pdf-export-mode #printable-guide h2,
        .pdf-export-mode #printable-guide h3,
        .pdf-export-mode #printable-guide h4 {
            margin-bottom: 0.75rem;
            font-weight: 700;
            color: #3D2B1F;
        }
        .pdf-export-mode #printable-guide h1 { font-size: 24pt; margin-bottom: 0.5rem; line-height: 1.2; }
        .pdf-export-mode #printable-guide h2 { font-size: 16pt; border-bottom: 1px solid rgba(61, 43, 31, 0.2); padding-bottom: 0.25rem; }
        .pdf-export-mode #printable-guide h3 { font-size: 12pt; }
        .pdf-export-mode #printable-guide h4 { font-size: 10pt; font-weight: 700; margin-bottom: 0.25rem; }
        .pdf-export-mode #printable-guide p, .pdf-export-mode #printable-guide li {
            font-size: 10pt;
            color: #3D2B1F;
        }
        .pdf-export-mode #printable-guide .font-semibold {
            font-weight: 600;
            color: #3D2B1F;
        }
        .pdf-export-mode #printable-guide .gap-6 { gap: 1rem; }
        .pdf-export-mode #printable-guide .gap-8 { gap: 1.25rem; }
        .pdf-export-mode #printable-guide .mb-6 { margin-bottom: 1rem; }
        .pdf-export-mode #printable-guide .mb-8 { margin-bottom: 1.25rem; }
        .pdf-export-mode #printable-guide .mt-2 { margin-top: 0.5rem; }
        .pdf-export-mode #printable-guide .mt-8 { margin-top: 1.25rem; }
        .pdf-export-mode #printable-guide .space-y-1 > * + * { margin-top: 0.25rem; }
        .pdf-export-mode #printable-guide .space-y-4 > * + * { margin-top: 0.5rem; }
        .pdf-export-mode #printable-guide .list-disc { list-style-type: disc; }
        .pdf-export-mode #printable-guide .list-inside { list-style-position: inside; }

        /* Styles for page 1 PDF layout */
        .pdf-garment-category {
            color: #C89B3C;
            font-size: 11pt;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        /* 2-column layout for sewing steps */
        .pdf-sewing-steps-grid {
            column-count: 2;
            column-gap: 1rem;
        }
        .pdf-sewing-steps-grid > div {
            break-inside: avoid;
            padding-bottom: 0.75rem;
        }
    </style>
<script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            'cinzel': ['"Cinzel Decorative"', 'serif'],
          },
          colors: {
            'theme-bg': 'var(--color-bg)',
            'theme-text': 'var(--color-text)',
            'theme-text-muted': 'var(--color-text-muted)',
            'theme-accent': 'var(--color-accent)',
            'theme-highlight': 'var(--color-highlight)',
            'theme-glass-bg': 'var(--color-glass-bg)',
            'theme-glass-border': 'var(--color-glass-border)',
            'theme-card-bg': 'var(--color-card-bg)',
            'theme-chip-bg': 'var(--color-chip-bg)',
            'theme-chip-text': 'var(--color-chip-text)',
            'theme-progress-bg': 'var(--color-progress-bg)',
            'theme-error': 'var(--color-error)',
            'theme-accent-glass-bg': 'var(--color-accent-glass-bg)',
            'theme-accent-glass-border': 'var(--color-accent-glass-border)',
            'theme-blue': '#1B3A63',
            'theme-gold': '#C89B3C',
          }
        }
      }
    }
</script>
</head>
<body class="bg-theme-bg text-theme-text">
    <div id="root"></div>
    <script type="module">
        import React, { useState, useCallback, useEffect, useRef, useMemo } from 'https://esm.sh/react@18.3.1';
        import ReactDOM from 'https://esm.sh/react-dom@18.3.1/client';
        import { GoogleGenAI, Type } from "https://esm.sh/@google/genai@0.14.0";
        import jsPDF from 'https://esm.sh/jspdf@2.5.1';
        import html2canvas from 'https://esm.sh/html2canvas@1.4.1';

        // --- Gemini Service ---
        const responseSchema = {
            type: Type.OBJECT,
            properties: {
                garmentAnalysis: {
                    type: Type.OBJECT,
                    properties: {
                        identifiedGarment: { type: Type.STRING, description: "E.g., 'High-Waisted A-Line Midi Skirt'" },
                        garmentDescription: { type: Type.STRING, description: "A short paragraph describing the key visual features of the garment in the image." },
                        keyFeatures: { type: Type.ARRAY, items: { type: Type.STRING }, description: "A list of key design elements. E.g., ['Pointed collar', 'Patch pockets']" },
                        styleCategory: { type: Type.STRING, description: "E.g. 'Jacket', 'Skirt', 'Blouse'" },
                        aiInsight: { type: Type.STRING, description: "A helpful tip or observation about construction or styling." },
                    },
                    required: ['identifiedGarment', 'garmentDescription', 'keyFeatures', 'styleCategory', 'aiInsight']
                },
                patternPieces: {
                    type: Type.ARRAY,
                    items: {
                        type: Type.OBJECT,
                        properties: {
                            name: { type: Type.STRING, description: "E.g., 'Front Bodice', 'Sleeve'" },
                            description: { type: Type.STRING, description: "A brief description of the piece and its key features." },
                        },
                        required: ['name', 'description']
                    }
                },
                fabricAndNotions: {
                    type: Type.OBJECT,
                    properties: {
                        fabricSuggestions: {
                            type: Type.ARRAY,
                            items: {
                                type: Type.OBJECT,
                                properties: {
                                    name: { type: Type.STRING, description: "E.g., 'Linen', 'Cotton Poplin'" },
                                    reason: { type: Type.STRING, description: "Why this fabric is suitable." },
                                },
                                required: ['name', 'reason']
                            }
                        },
                        notions: { type: Type.ARRAY, items: { type: Type.STRING }, description: "A list of required notions. E.g., ['Matching thread', '7x 1/2\" buttons']" },
                        recommendedSeamAllowance: { type: Type.STRING, description: "E.g., '1/2 inch (1.5 cm)'" },
                    },
                    required: ['fabricSuggestions', 'notions', 'recommendedSeamAllowance']
                },
                sewingSteps: {
                    type: Type.ARRAY,
                    items: {
                        type: Type.OBJECT,
                        properties: {
                            step: { type: Type.INTEGER },
                            title: { type: Type.STRING, description: "A short, clear title for the step. E.g., 'Prepare and Sew Darts'" },
                            details: { type: Type.STRING, description: "A concise explanation of how to perform the step." },
                        },
                        required: ['step', 'title', 'details']
                    }
                }
            },
            required: ['garmentAnalysis', 'patternPieces', 'fabricAndNotions', 'sewingSteps']
        };

        const SYSTEM_INSTRUCTION = `You are a world-class expert fashion designer, pattern maker, and sewing instructor. Your task is to analyze an image of a garment and produce a comprehensive, structured guide for recreating it in the specified JSON format. Be thorough, clear, and encouraging in your text.`;
        const USER_PROMPT = `Analyze the garment in the provided image and generate the sewing guide.`;
        
        const generateSewingGuideFromImage = async (ai, base64Image, imageType) => {
            const imagePart = {
                inlineData: {
                    mimeType: imageType,
                    data: base64Image,
                },
            };

            const textPart = {
                text: USER_PROMPT,
            };

            try {
                const response = await ai.models.generateContent({
                    model: 'gemini-2.5-flash',
                    contents: { parts: [textPart, imagePart] },
                    config: {
                        systemInstruction: SYSTEM_INSTRUCTION,
                        responseMimeType: 'application/json',
                        responseSchema: responseSchema,
                        temperature: 0.2
                    }
                });
                
                const jsonText = response.text.trim();
                const parsedData = JSON.parse(jsonText);
                
                return parsedData;

            } catch (e) {
                console.error("Error generating guide from AI:", e);
                const errorMessage = e instanceof Error ? e.message : "An unknown error occurred.";
                throw new Error(`Failed to generate sewing guide. ${errorMessage}`);
            }
        };


        // --- Icon Components ---
        const LOGO_SOURCE = '';

        const LogoIcon = ({ className }) => {
            if (LOGO_SOURCE) {
                return React.createElement('img', { src: LOGO_SOURCE, alt: 'Logo', className });
            }
            return React.createElement('svg', {
                className,
                viewBox: '0 0 100 100',
                fill: 'none',
                xmlns: 'http://www.w3.org/2000/svg',
                stroke: 'currentColor',
                strokeWidth: '4'
            },
                React.createElement('path', { d: 'M50 10 L90 50 L50 90 L10 50 Z', strokeLinecap: 'round', strokeLinejoin: 'round' }),
                React.createElement('path', { d: 'M50 10 V 90', strokeLinecap: 'round', strokeLinejoin: 'round' }),
                React.createElement('path', { d: 'M10 50 H 90', strokeLinecap: 'round', strokeLinejoin: 'round' }),
                React.createElement('path', { d: 'M20 30 L80 70', strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: '2' }),
                React.createElement('path', { d: 'M20 70 L80 30', strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: '2' })
            );
        };
        const SunIcon = ({ className }) => React.createElement('svg', { className, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', strokeWidth: 1.5, stroke: 'currentColor' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z' })
        );
        const MoonIcon = ({ className }) => React.createElement('svg', { className, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', strokeWidth: 1.5, stroke: 'currentColor' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z' })
        );
        const UploadIcon = ({ className }) => React.createElement('svg', { className, 'aria-hidden': 'true', xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 20 16' },
            React.createElement('path', { stroke: 'currentColor', strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: '2', d: 'M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2' })
        );
        const CameraIcon = ({ className }) => React.createElement('svg', { className, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', strokeWidth: 1.5, stroke: 'currentColor' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z' }),
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z' })
        );
        const WarningIcon = ({ className }) => React.createElement('svg', { className, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', strokeWidth: 1.5, stroke: 'currentColor' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z' })
        );
        const SparklesIcon = ({ className }) => React.createElement('svg', { className, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', strokeWidth: 1.5, stroke: 'currentColor' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.562L16.25 21.75l-.648-1.188a2.25 2.25 0 01-1.4-1.4L13.063 18l1.188-.648a2.25 2.25 0 011.4 1.4l.648 1.188z' })
        );
        const RulerIcon = ({ className }) => React.createElement('svg', { className, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', strokeWidth: 1.5, stroke: 'currentColor' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125' })
        );
        const SwatchIcon = ({ className }) => React.createElement('svg', { className, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', strokeWidth: 1.5, stroke: 'currentColor' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25' })
        );
        const ScissorsIcon = ({ className }) => React.createElement('svg', { className, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', strokeWidth: 1.5, stroke: 'currentColor' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M7.843 16.237a3.375 3.375 0 004.326 4.326l9.528-9.528a3.375 3.375 0 00-4.326-4.326L7.843 16.237z' }),
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M16.16 3.837a3.375 3.375 0 00-4.326 4.326l5.483 5.483a3.375 3.375 0 004.326-4.326l-5.483-5.483z' }),
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M9 21a3 3 0 100-6 3 3 0 000 6z' }),
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M15 15a3 3 0 100-6 3 3 0 000 6z' })
        );
        const CheckCircleIcon = ({ className }) => React.createElement('svg', { className, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', strokeWidth: 1.5, stroke: 'currentColor' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z' })
        );
        const DocumentArrowDownIcon = ({ className }) => React.createElement('svg', { className, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', strokeWidth: 1.5, stroke: 'currentColor' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M9 13.5l3 3m0 0l3-3m-3 3v-6m1.06-4.19l-2.12-2.12a1.5 1.5 0 00-1.061-.44H4.5A2.25 2.25 0 002.25 6v12a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9a2.25 2.25 0 00-2.25-2.25h-5.379a1.5 1.5 0 01-1.06-.44z' })
        );
        const ArrowUturnLeftIcon = ({ className }) => React.createElement('svg', { className, xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24', strokeWidth: 1.5, stroke: 'currentColor' },
            React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', d: 'M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3' })
        );

        // --- Loader Component ---
        const Loader = () => {
            return React.createElement('div', { className: 'flex flex-col items-center justify-center text-center p-8 animate-fade-in' },
                React.createElement('div', { className: 'relative' },
                    React.createElement('svg', { className: 'animate-spin h-16 w-16 text-theme-accent', xmlns: 'http://www.w3.org/2000/svg', fill: 'none', viewBox: '0 0 24 24' },
                        React.createElement('circle', { className: 'opacity-25', cx: '12', cy: '12', r: '10', stroke: 'currentColor', strokeWidth: '4' }),
                        React.createElement('path', { className: 'opacity-75', fill: 'currentColor', d: 'M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z' })
                    ),
                    React.createElement(SparklesIcon, { className: 'w-8 h-8 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-theme-accent opacity-75' })
                ),
                React.createElement('p', { className: 'mt-6 font-semibold text-lg text-theme-text' }, 'Analyzing your garment...'),
                React.createElement('p', { className: 'text-sm text-theme-text-muted max-w-xs' }, 'Our AI is drafting patterns and preparing your personalized sewing guide. This may take a moment.')
            );
        };

        // --- UploadScreen Component ---
        const SUPPORTED_MIME_TYPES = ['image/jpeg', 'image/png', 'image/webp', 'image/heic', 'image/heif'];
        const SUPPORTED_FORMATS_TEXT = 'PNG, JPG, WEBP, or HEIC';
        
        const UploadScreen = ({ onImageSelected }) => {
            const inputRef = useRef(null);
            const videoRef = useRef(null);
            const [isCameraActive, setIsCameraActive] = useState(false);
            const [stream, setStream] = useState(null);
        
            const handleFileSelect = (files) => {
                if (files && files[0]) {
                    const file = files[0];
                    if (SUPPORTED_MIME_TYPES.includes(file.type)) {
                        onImageSelected(file);
                    } else {
                        alert(`Unsupported file type. Please use ${SUPPORTED_FORMATS_TEXT}.`);
                    }
                }
            };
        
            const stopCamera = useCallback(() => {
                if (stream) {
                    stream.getTracks().forEach(track => track.stop());
                    setIsCameraActive(false);
                    setStream(null);
                }
            }, [stream]);
        
            const startCamera = async () => {
                stopCamera();
                try {
                    const mediaStream = await navigator.mediaDevices.getUserMedia({ 
                        video: { facingMode: 'environment' },
                        audio: false
                    });
                    setStream(mediaStream);
                    setIsCameraActive(true);
                    if (videoRef.current) {
                        videoRef.current.srcObject = mediaStream;
                    }
                } catch (err) {
                    console.error("Camera error:", err);
                    alert("Could not access the camera. Please ensure you have given the necessary permissions.");
                }
            };
            
            const handleCapture = () => {
                if (!videoRef.current) return;
                const canvas = document.createElement('canvas');
                canvas.width = videoRef.current.videoWidth;
                canvas.height = videoRef.current.videoHeight;
                const ctx = canvas.getContext('2d');
                if (!ctx) return;
        
                ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);
                canvas.toBlob((blob) => {
                    if (blob) {
                        const file = new File([blob], `capture-${Date.now()}.png`, { type: 'image/png' });
                        onImageSelected(file);
                        stopCamera();
                    }
                }, 'image/png');
            };
        
            return React.createElement('div', { className: 'w-full max-w-2xl text-center animate-fade-in' },
                React.createElement('div', { className: 'bg-theme-card-bg backdrop-blur-xl border border-theme-glass-border p-8 sm:p-12 rounded-[20px] shadow-xl' },
                    React.createElement('h1', { className: 'text-3xl sm:text-4xl font-bold text-theme-text' }, "Let's get sewing"),
                    React.createElement('p', { className: 'text-theme-text-muted mt-2' }, 'Upload a photo of a garment to begin generating your guide.'),
                    isCameraActive ? (
                        React.createElement('div', { className: 'mt-8' },
                            React.createElement('video', { ref: videoRef, autoPlay: true, playsInline: true, className: 'w-full rounded-lg bg-black' }),
                            React.createElement('div', { className: 'flex items-center justify-center gap-4 mt-4' },
                                React.createElement('button', { onClick: handleCapture, className: 'pill-button w-full text-white bg-theme-accent hover:opacity-90' }, 'Snap Photo'),
                                React.createElement('button', { onClick: stopCamera, className: 'pill-button w-full text-theme-text bg-theme-text/10 hover:bg-theme-text/20' }, 'Cancel')
                            )
                        )
                    ) : (
                        React.createElement('div', { className: 'mt-8 grid sm:grid-cols-2 gap-6' },
                            React.createElement('button', { 
                                onClick: () => inputRef.current?.click(),
                                className: 'flex flex-col items-center justify-center gap-3 p-6 bg-theme-card-bg backdrop-blur-lg border border-theme-glass-border rounded-2xl text-theme-accent shadow-lg transform hover:-translate-y-0.5 transition-all duration-300 hover:shadow-xl hover:border-theme-highlight dark:hover:border-theme-accent'
                            },
                                React.createElement(UploadIcon, { className: 'w-8 h-8' }),
                                React.createElement('span', { className: 'font-semibold' }, 'Upload from Device'),
                                React.createElement('span', { className: 'text-xs text-theme-accent/80' }, SUPPORTED_FORMATS_TEXT)
                            ),
                            React.createElement('button', {
                                onClick: startCamera,
                                className: 'flex flex-col items-center justify-center gap-3 p-6 bg-theme-card-bg backdrop-blur-lg border border-theme-glass-border rounded-2xl text-theme-text shadow-lg transform hover:-translate-y-0.5 transition-all duration-300 hover:shadow-xl hover:border-theme-highlight dark:hover:border-theme-highlight'
                            },
                               React.createElement(CameraIcon, { className: 'w-8 h-8 text-theme-highlight' }),
                               React.createElement('span', { className: 'font-semibold' }, 'Use Camera'),
                               React.createElement('span', { className: 'text-xs text-theme-text-muted' }, 'For real-world items')
                            )
                        )
                    )
                ),
                 React.createElement('input', {
                    ref: inputRef,
                    type: 'file',
                    className: 'hidden',
                    accept: SUPPORTED_MIME_TYPES.join(','),
                    onChange: (e) => handleFileSelect(e.target.files)
                })
            );
        };
        
        // --- GuideViewer Component ---
        const TABS = [
            { id: 'analysis', name: 'Analysis', icon: SparklesIcon },
            { id: 'patterns', name: 'Pattern Pieces', icon: RulerIcon },
            { id: 'materials', name: 'Materials', icon: SwatchIcon },
            { id: 'sewing', name: 'Sewing Guide', icon: ScissorsIcon },
        ];
        
        const AnalysisContent = ({ analysis }) => (
            React.createElement('div', { className: 'grid md:grid-cols-3 gap-6 animate-fade-in' },
                React.createElement('div', { className: 'md:col-span-2 p-5 rounded-2xl bg-theme-card-bg border border-theme-glass-border backdrop-blur-lg' },
                    React.createElement('h3', { className: 'text-lg font-semibold text-theme-text mb-3' }, 'Key Features'),
                    React.createElement('div', { className: 'flex flex-wrap gap-2' },
                        analysis.keyFeatures.map((feature, i) => React.createElement('span', { key: i, className: 'px-3 py-1 text-sm font-medium bg-theme-chip-bg text-theme-chip-text rounded-full' }, feature))
                    )
                ),
                React.createElement('div', null,
                    React.createElement('div', { className: 'bg-theme-accent-glass-bg backdrop-blur-lg border border-theme-accent-glass-border rounded-2xl p-4' },
                        React.createElement('div', { className: 'flex items-center gap-3' },
                            React.createElement(SparklesIcon, { className: 'w-6 h-6 text-theme-accent flex-shrink-0' }),
                            React.createElement('h4', { className: 'font-semibold text-theme-accent' }, 'AI Insight')
                        ),
                        React.createElement('p', { className: 'text-sm text-theme-accent/80 mt-2' }, analysis.aiInsight)
                    )
                )
            )
        );
        
        const PatternsContent = ({ pieces }) => (
            React.createElement('div', { className: 'grid sm:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in' },
                pieces.map((piece, i) => (
                    React.createElement('div', { key: i, className: 'bg-theme-card-bg backdrop-blur-lg p-5 rounded-2xl border border-theme-glass-border shadow-sm' },
                        React.createElement('h4', { className: 'font-semibold text-theme-text' }, piece.name),
                        React.createElement('p', { className: 'text-sm text-theme-text-muted mt-1' }, piece.description)
                    )
                ))
            )
        );
        
        const MaterialsContent = ({ materials }) => (
             React.createElement('div', { className: 'grid md:grid-cols-2 gap-8 animate-fade-in' },
                React.createElement('div', null,
                    React.createElement('h3', { className: 'text-lg font-semibold text-theme-text mb-4' }, 'Fabric Suggestions'),
                    React.createElement('div', { className: 'space-y-4' },
                        materials.fabricSuggestions.map((fab, i) => (
                            React.createElement('div', { key: i, className: 'bg-theme-card-bg backdrop-blur-lg p-4 rounded-2xl border border-theme-glass-border' },
                                React.createElement('h4', { className: 'font-semibold text-theme-text' }, fab.name),
                                React.createElement('p', { className: 'text-sm text-theme-text-muted mt-1' }, fab.reason)
                            )
                        ))
                    )
                ),
                React.createElement('div', null,
                    React.createElement('h3', { className: 'text-lg font-semibold text-theme-text mb-4' }, 'Notions & Tools'),
                    React.createElement('div', { className: 'bg-theme-card-bg backdrop-blur-lg p-5 rounded-2xl border border-theme-glass-border' },
                        React.createElement('ul', { className: 'space-y-2' },
                            materials.notions.map((notion, i) => (
                                React.createElement('li', { key: i, className: 'flex items-center gap-3 text-sm text-theme-text' },
                                    React.createElement('div', { className: 'w-1 h-1 bg-theme-text-muted rounded-full' }),
                                    notion
                                )
                            ))
                        ),
                        React.createElement('div', { className: 'border-t border-theme-glass-border my-4' }),
                        React.createElement('h4', { className: 'font-semibold text-theme-text' }, 'Seam Allowance'),
                        React.createElement('p', { className: 'text-sm text-theme-text-muted mt-1' }, materials.recommendedSeamAllowance)
                    )
                )
            )
        );
        
        const SewingContent = ({ steps, completedSteps, onStepToggle }) => (
            React.createElement('div', { className: 'animate-fade-in max-w-3xl mx-auto' },
                React.createElement('div', { className: 'flex items-center justify-between mb-4' },
                    React.createElement('h3', { className: 'text-lg font-semibold text-theme-text' }, 'Construction Steps'),
                    React.createElement('p', { className: 'text-sm font-medium text-theme-text-muted' }, `${completedSteps.size} of ${steps.length} completed`)
                ),
                React.createElement('div', { className: 'w-full bg-theme-progress-bg rounded-full h-2 mb-6' },
                    React.createElement('div', { className: 'bg-theme-accent h-2 rounded-full transition-all duration-300', style: { width: `${(completedSteps.size / steps.length) * 100}%` } })
                ),
                React.createElement('div', { className: 'space-y-4' },
                    steps.map(step => (
                        React.createElement('button', { key: step.step, onClick: () => onStepToggle(step.step), className: 'w-full text-left flex gap-4 items-start p-4 bg-theme-card-bg backdrop-blur-lg rounded-2xl border border-theme-glass-border shadow-sm hover:border-theme-accent/50 transition-colors' },
                            React.createElement(CheckCircleIcon, { className: `w-8 h-8 flex-shrink-0 mt-0.5 transition-colors ${completedSteps.has(step.step) ? 'text-theme-highlight' : 'text-theme-text/20'}` }),
                            React.createElement('div', null,
                                React.createElement('p', { className: 'font-semibold text-theme-text' }, `${step.step}. ${step.title}`),
                                React.createElement('p', { className: 'text-sm text-theme-text-muted mt-1' }, step.details)
                            )
                        )
                    ))
                )
            )
        );
        
        const GuideViewer = ({ guide, imageFile, onReset }) => {
            const [activeTab, setActiveTab] = useState('analysis');
            const imageUrl = useMemo(() => URL.createObjectURL(imageFile), [imageFile]);
            const [completedSteps, setCompletedSteps] = useState(new Set());
            const [isExporting, setIsExporting] = useState(false);
        
            const handleStepToggle = (stepNumber) => {
                setCompletedSteps(prev => {
                    const newSet = new Set(prev);
                    if (newSet.has(stepNumber)) {
                        newSet.delete(stepNumber);
                    } else {
                        newSet.add(stepNumber);
                    }
                    return newSet;
                });
            };
            
            const handleExportPdf = async () => {
                setIsExporting(true);
                document.body.classList.add('pdf-export-mode');
                await new Promise(resolve => setTimeout(resolve, 100));
        
                const printableElement = document.getElementById('printable-guide');
                if (!printableElement) {
                    setIsExporting(false);
                    document.body.classList.remove('pdf-export-mode');
                    console.error("Printable element not found");
                    return;
                }
        
                try {
                    const pdf = new jsPDF('p', 'mm', 'a4');
                    const pdfWidth = pdf.internal.pageSize.getWidth();
                    const pdfHeight = pdf.internal.pageSize.getHeight();
                    const pageElements = Array.from(printableElement.querySelectorAll('.pdf-page'));
        
                    for (let i = 0; i < pageElements.length; i++) {
                        const page = pageElements[i];
                        const canvas = await html2canvas(page, {
                            scale: 2,
                            useCORS: true,
                            logging: false,
                            width: page.offsetWidth,
                            height: page.offsetHeight,
                        });
                        
                        const imgData = canvas.toDataURL('image/jpeg', 0.98);
        
                        if (i > 0) {
                            pdf.addPage();
                        }
        
                        pdf.addImage(imgData, 'JPEG', 0, 0, pdfWidth, pdfHeight);
                    }
        
                    const fileName = `sewing-guide-${guide.garmentAnalysis.identifiedGarment.toLowerCase().replace(/\s+/g, '-')}.pdf`;
                    pdf.save(fileName);
        
                } catch (error) {
                    console.error("Failed to export PDF:", error);
                    alert("Sorry, there was an issue creating the PDF. Please try again.");
                } finally {
                    document.body.classList.remove('pdf-export-mode');
                    setIsExporting(false);
                }
            };
            
            const interactiveView = React.createElement('div', { className: 'w-full animate-fade-in flex flex-col max-w-7xl mx-auto' },
                React.createElement('div', { className: 'flex flex-col md:flex-row gap-6 md:gap-8 mb-8' },
                    React.createElement('div', { className: 'md:w-1/3 flex-shrink-0' },
                        React.createElement('img', { src: imageUrl, alt: imageFile.name, className: 'w-full rounded-[20px] object-cover aspect-[4/5] bg-theme-progress-bg shadow-lg border border-theme-glass-border' })
                    ),
                    React.createElement('div', { className: 'flex-grow flex flex-col' },
                        React.createElement('p', { className: 'text-theme-accent dark:text-theme-highlight font-semibold' }, guide.garmentAnalysis.styleCategory),
                        React.createElement('h1', { className: 'text-3xl lg:text-4xl font-bold text-theme-text mt-1' }, guide.garmentAnalysis.identifiedGarment),
                        React.createElement('p', { className: 'text-theme-text-muted mt-3 text-base leading-relaxed' }, guide.garmentAnalysis.garmentDescription),
                        React.createElement('div', { className: 'mt-auto pt-6 flex flex-col sm:flex-row gap-3' },
                             React.createElement('button', { onClick: onReset, className: 'flex items-center justify-center gap-2 w-full sm:w-auto px-5 py-2.5 text-sm font-semibold text-theme-text bg-theme-text/10 border border-theme-glass-border rounded-full hover:bg-theme-text/20 transition-colors' },
                                React.createElement(ArrowUturnLeftIcon, { className: 'w-4 h-4' }),
                                React.createElement('span', null, 'Start Over')
                            ),
                            React.createElement('button', { onClick: handleExportPdf, disabled: isExporting, className: 'flex items-center justify-center gap-2 w-full sm:w-auto px-5 py-2.5 text-sm font-semibold text-white bg-theme-accent rounded-full hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-wait' },
                                 React.createElement(DocumentArrowDownIcon, { className: 'w-4 h-4' }),
                                 React.createElement('span', null, isExporting ? 'Generating PDF...' : 'Export PDF')
                            )
                        )
                    )
                ),
                React.createElement('div', { className: 'border-b border-theme-glass-border' },
                    React.createElement('nav', { className: '-mb-px flex gap-6', 'aria-label': 'Tabs' },
                        TABS.map(tab => React.createElement('button', { key: tab.id, onClick: () => setActiveTab(tab.id), className: `${activeTab === tab.id ? 'border-theme-highlight text-theme-highlight' : 'border-transparent text-theme-text-muted hover:text-theme-highlight hover:border-theme-highlight/50'} flex items-center gap-2 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors` },
                           React.createElement(tab.icon, { className: 'w-5 h-5' }),
                           tab.name
                        ))
                    )
                ),
                React.createElement('div', { className: 'py-8 bg-theme-card-bg/50 backdrop-blur-xl -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8 mt-px rounded-b-[20px] border-x border-b border-theme-glass-border' },
                    activeTab === 'analysis' && React.createElement(AnalysisContent, { analysis: guide.garmentAnalysis }),
                    activeTab === 'patterns' && React.createElement(PatternsContent, { pieces: guide.patternPieces }),
                    activeTab === 'materials' && React.createElement(MaterialsContent, { materials: guide.fabricAndNotions }),
                    activeTab === 'sewing' && React.createElement(SewingContent, { steps: guide.sewingSteps, completedSteps, onStepToggle: handleStepToggle })
                )
            );
        
            const printableGuide = React.createElement('div', { id: 'printable-guide' },
                React.createElement('div', { className: 'pdf-page' },
                     React.createElement('div', { className: 'flex gap-8 mb-6' },
                        React.createElement('div', { className: 'w-[38%] flex-shrink-0' },
                            React.createElement('img', { src: imageUrl, alt: imageFile.name, className: 'w-full rounded-lg' })
                        ),
                        React.createElement('div', { className: 'flex-grow flex flex-col' },
                            React.createElement('p', { className: 'pdf-garment-category' }, guide.garmentAnalysis.styleCategory),
                            React.createElement('h1', null, guide.garmentAnalysis.identifiedGarment),
                            React.createElement('p', null, guide.garmentAnalysis.garmentDescription)
                        )
                    ),
                    React.createElement('div', { className: 'mb-6' },
                       React.createElement('h3', null, 'Key Features'),
                       React.createElement('ul', { className: 'list-disc list-inside space-y-1 mt-2' },
                           guide.garmentAnalysis.keyFeatures.map((feature, i) => React.createElement('li', { key: i }, feature))
                       )
                    ),
                    React.createElement('div', null,
                       React.createElement('h3', null, 'AI Insight'),
                       React.createElement('p', { className: 'mt-2' }, guide.garmentAnalysis.aiInsight)
                    )
                ),
                React.createElement('div', { className: 'pdf-page' },
                    React.createElement('h2', null, 'Pattern Pieces'),
                    React.createElement('div', { className: 'grid grid-cols-2 gap-6' },
                        guide.patternPieces.map((piece, i) => (
                            React.createElement('div', { key: i },
                                React.createElement('h4', null, piece.name),
                                React.createElement('p', null, piece.description)
                            )
                        ))
                    ),
                    React.createElement('h2', { className: 'mt-8' }, 'Materials & Notions'),
                    React.createElement('div', { className: 'grid grid-cols-2 gap-8' },
                        React.createElement('div', null,
                            React.createElement('h3', null, 'Fabric Suggestions'),
                            React.createElement('div', { className: 'space-y-4' },
                                guide.fabricAndNotions.fabricSuggestions.map((fab, i) => (
                                    React.createElement('div', { key: i },
                                        React.createElement('h4', null, fab.name),
                                        React.createElement('p', null, fab.reason)
                                    )
                                ))
                            )
                        ),
                        React.createElement('div', null,
                            React.createElement('h3', null, 'Notions & Tools'),
                            React.createElement('ul', { className: 'list-disc list-inside space-y-1' },
                                guide.fabricAndNotions.notions.map((notion, i) => React.createElement('li', { key: i }, notion))
                            ),
                            React.createElement('h4', { className: 'mt-4' }, 'Seam Allowance'),
                            React.createElement('p', null, guide.fabricAndNotions.recommendedSeamAllowance)
                        )
                    )
                ),
                React.createElement('div', { className: 'pdf-page' },
                    React.createElement('h2', null, 'Sewing Guide'),
                    React.createElement('div', { className: 'pdf-sewing-steps-grid' },
                        guide.sewingSteps.map(step => (
                            React.createElement('div', { key: step.step },
                                React.createElement('p', { className: 'font-semibold' }, `${step.step}. ${step.title}`),
                                React.createElement('p', { className: 'mt-1' }, step.details)
                            )
                        ))
                    )
                )
            );
        
            return (
                React.createElement('div', { className: 'w-full max-w-7xl mx-auto' },
                    interactiveView,
                    React.createElement('div', { className: isExporting ? '' : 'hidden' },
                        printableGuide
                    )
                )
            );
        };
        
        // --- Header Component ---
        const Header = ({ theme, toggleTheme }) => {
            return (
                React.createElement('header', { className: 'bg-theme-glass-bg backdrop-filter backdrop-blur-lg border-b border-theme-glass-border sticky top-0 z-20' },
                    React.createElement('div', { className: 'max-w-7xl mx-auto px-4 sm:px-6 lg:p-8' },
                        React.createElement('div', { className: 'flex justify-between items-center py-4' },
                            React.createElement('div', { className: 'flex items-center gap-3' },
                                React.createElement(LogoIcon, { className: 'w-8 h-8' }),
                                React.createElement('h1', { className: 'text-xl font-bold text-theme-text tracking-wider font-cinzel' }, 'Mystic Lore Garment Analyzer')
                            ),
                            React.createElement('button', { onClick: toggleTheme, className: 'p-2 rounded-full text-theme-highlight hover:bg-theme-text/10 transition-colors focus:outline-none focus:ring-2 focus:ring-theme-highlight' },
                                theme === 'light' ? 
                                React.createElement(MoonIcon, { className: 'w-6 h-6' }) : 
                                React.createElement(SunIcon, { className: 'w-6 h-6' })
                            )
                        )
                    )
                )
            );
        };

        // --- App Component ---
        const App = () => {
            const [theme, setTheme] = useState('light');
            const [screen, setScreen] = useState('upload');
            const [imageFile, setImageFile] = useState(null);
            const [sewingGuide, setSewingGuide] = useState(null);
            const [error, setError] = useState(null);
            const [ai, setAi] = useState(null);
            const [apiKeyError, setApiKeyError] = useState(null);

            useEffect(() => {
                if (theme === 'dark') {
                    document.body.classList.add('dark');
                } else {
                    document.body.classList.remove('dark');
                }
            }, [theme]);

            useEffect(() => {
                try {
                    const API_KEY = process.env.API_KEY;
                    if (!API_KEY) {
                        throw new Error("API_KEY environment variable is not set. Please configure it to use the application.");
                    }
                    const genAI = new GoogleGenAI({ apiKey: API_KEY });
                    setAi(genAI);
                } catch (e) {
                    console.error(e);
                    setApiKeyError(e.message);
                }
            }, []);
        
            const toggleTheme = useCallback(() => {
                setTheme(prevTheme => prevTheme === 'light' ? 'dark' : 'light');
            }, []);
        
            const handleImageSelected = useCallback((file) => {
                if (!ai) {
                    setError("Gemini AI client is not initialized.");
                    setScreen('error');
                    return;
                }
                setImageFile(file);
                setSewingGuide(null);
                setError(null);
                setScreen('loading');
        
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = async () => {
                    try {
                        if (typeof reader.result !== 'string') {
                            throw new Error('Failed to read file as base64 string.');
                        }
                        const base64Image = reader.result.split(',')[1];
                        const imageType = file.type;
                        const generatedGuide = await generateSewingGuideFromImage(ai, base64Image, imageType);
                        setSewingGuide(generatedGuide);
                        setScreen('results');
                    } catch (err) {
                        console.error(err);
                        const errorMessage = err instanceof Error ? err.message : 'An unknown error occurred.';
                        setError(errorMessage);
                        setScreen('error');
                    }
                };
                reader.onerror = () => {
                     setError("Could not read the selected file.");
                     setScreen('error');
                };
            }, [ai]);
        
            const handleReset = useCallback(() => {
                setScreen('upload');
                setImageFile(null);
                setSewingGuide(null);
                setError(null);
            }, []);
            
            const renderContent = () => {
                if (apiKeyError) {
                    return React.createElement('div', { className: 'text-center p-8 bg-theme-card-bg backdrop-blur-lg rounded-[20px] border border-theme-glass-border animate-fade-in max-w-lg shadow-xl' },
                        React.createElement(WarningIcon, { className: 'w-12 h-12 text-theme-error mx-auto' }),
                        React.createElement('h2', { className: 'mt-4 text-xl font-bold text-theme-text' }, 'Configuration Error'),
                        React.createElement('p', { className: 'mt-2 text-sm text-theme-text-muted' }, apiKeyError),
                    );
                }

                if (!ai) {
                    return React.createElement(Loader);
                }

                switch (screen) {
                    case 'upload':
                        return React.createElement(UploadScreen, { onImageSelected: handleImageSelected });
                    case 'loading':
                        return React.createElement(Loader);
                    case 'results':
                        if (sewingGuide && imageFile) {
                            return React.createElement(GuideViewer, { guide: sewingGuide, imageFile: imageFile, onReset: handleReset });
                        }
                        setError("Something went wrong displaying the results.");
                        setScreen('error');
                        return null;
                    case 'error':
                        return React.createElement('div', { className: 'text-center p-8 bg-theme-card-bg backdrop-blur-lg rounded-[20px] border border-theme-glass-border animate-fade-in max-w-lg shadow-xl' },
                            React.createElement(WarningIcon, { className: 'w-12 h-12 text-theme-error mx-auto' }),
                            React.createElement('h2', { className: 'mt-4 text-xl font-bold text-theme-text' }, 'Analysis Failed'),
                            React.createElement('p', { className: 'mt-2 text-sm text-theme-text-muted' }, error || "An unknown error occurred."),
                            React.createElement('button', { onClick: handleReset, className: 'mt-6 pill-button bg-theme-accent text-white hover:opacity-90' }, 'Try Again')
                        );
                    default:
                        return null;
                }
            };
        
            return React.createElement('div', { className: 'min-h-screen flex flex-col' },
                React.createElement(Header, { theme, toggleTheme }),
                React.createElement('main', { className: 'flex-grow flex items-center justify-center p-4 sm:p-6 lg:p-8' },
                    renderContent()
                )
            );
        };

        // --- Render App ---
        const rootElement = document.getElementById('root');
        if (!rootElement) {
          throw new Error("Could not find root element to mount to");
        }
        
        const root = ReactDOM.createRoot(rootElement);
        root.render(
          React.createElement(React.StrictMode, null, 
            React.createElement(App, null)
          )
        );
    </script>
</body>
</html>